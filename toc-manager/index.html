<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>TOC Manager (Super)</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="/favicon.ico" sizes="any" />
  <link rel="icon" type="image/png" href="/favicon.png" />
  <link rel="apple-touch-icon" href="/touch-icon-192x192.png" />
  <link rel="manifest" href="/site.webmanifest" />
<style>
  :root { --pad:12px; --br:10px; --shadow:0 6px 24px rgba(0,0,0,.08); --content-width: 1000px; }
  body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; margin:0; background:#f7f7f9; color:#111; }
  header { padding:16px 20px; background:#fff; box-shadow: var(--shadow); position:sticky; top:0; z-index:3; }
  .container { max-width: var(--content-width); margin: 0 auto; padding: 0 20px; }
  main { padding: 20px; max-width: var(--content-width); margin: 0 auto; }
  .row { display:flex; gap:12px; flex-wrap:wrap; align-items:center; }
  input[type="text"], textarea, input[type="url"] { padding:10px 12px; border:1px solid #ddd; border-radius:10px; background:#fff; min-width:280px; }
  button { padding:10px 14px; border-radius:10px; border:1px solid #ddd; background:#fff; cursor:pointer; transition:background .15s ease,border-color .15s ease, color .15s ease; }
  button.primary { background:#2563eb; color:#fff; border-color:#2563eb; box-shadow:0 1px 2px rgba(37,99,235,.2); }
  button.secondary { background:#f3f4f6; color:#374151; border-color:#e5e7eb; }
  section.card { background:#fff; border:1px solid #eee; border-radius:16px; padding:16px; box-shadow: var(--shadow); margin-top:16px; }
  #list { list-style:none; padding:0; margin:0; }
  .item { display:flex; align-items:center; gap:10px; padding:10px; border:1px solid #eee; border-radius:12px; margin-bottom:8px; background:#fff; }
  .item[draggable="true"] { cursor:grab; }
  .dragging { opacity:.5; }
  .pill { font-size:12px; padding:3px 8px; border-radius:999px; border:1px solid #ddd; background:#fafafa; }
  .path { color:#555; font-size:12px; }
  .title-input { flex:1; min-width:160px; }
  .muted { color:#777; }
  .new { outline: 2px dashed #3b82f6; }
  .stale { background: #fff7f7; border-color:#ffdede; }
  details { margin-top:10px; }
  pre.copy { background:#0a0a0a; color:#fff; padding:12px; border-radius:12px; overflow:auto; }
  .grid { display:grid; grid-template-columns: 2fr 1fr; gap:16px; }
  @media (max-width: 1100px){
    .grid { grid-template-columns: 1fr; }
    header .row { flex-wrap: wrap; gap:8px; }
  }
  /* Grouped hierarchy visuals */
  .group { list-style:none; margin:16px 0 6px; padding:0; border:none; }
  .group-title { font-weight:600; padding:6px 8px; border-left:4px solid #e5e7eb; background:#f9fafb; border-radius:8px; display:flex; align-items:center; gap:8px; }
  .group-path { color:#6b7280; font-weight:400; font-size:12px; }
  .item.indent { padding-left:28px; }
  .collapse-btn { border:none; background:transparent; cursor:pointer; font-size:14px; line-height:1; padding:0 4px; }
  .group.collapsed .group-title { background:#eef2ff; }
  .help { margin-top:12px; border-top:1px dashed #e5e7eb; padding-top:12px; color:#374151; font-size:13px; }
  .help h4 { margin:6px 0 8px; font-size:13px; }
  .help ol { margin:0; padding-left:16px; }
  .help li { margin:6px 0; }
  .help .muted { color:#6b7280; }
  /* Instructions styling */
  .steps { list-style:none; padding-left:0; margin:0; }
  .step { display:flex; align-items:flex-start; gap:10px; margin:10px 0; }
  .step .num { width:26px; height:26px; border-radius:999px; background:#2563eb; color:#fff; display:flex; align-items:center; justify-content:center; font-weight:700; font-size:12px; flex:0 0 26px; }
  .subcard { background:#f9fafb; border:1px solid #eef2ff; border-radius:12px; padding:12px 14px; margin:12px 0; }
  .tag { display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; border:1px solid #e5e7eb; color:#374151; }
  .tag.required { background:#dbeafe; border-color:#bfdbfe; color:#1d4ed8; }
  .tag.optional { background:#f3f4f6; }
  kbd { background:#f3f4f6; border:1px solid #e5e7eb; border-bottom-width:2px; border-radius:6px; padding:0 6px; font-size:12px; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  .callout { background:#fffbeb; border-left:4px solid #f59e0b; padding:10px 12px; border-radius:8px; }
</style>
</head>
<body>
<header>
  <div class="row container">
  <strong><img src="/touch-icon-192x192.png" alt="App" style="height:32px;width:32px;border-radius:8px;vertical-align:middle;margin-right:10px">TOC Manager</strong>
  <div style="flex:1"></div>
  <button id="loadSitemapBtn" class="primary">Load Sitemap</button>
  <button id="saveSnapshotBtn" class="secondary">Save Snapshot</button>
  <button id="loadSnapshotBtn" class="secondary">Load Snapshot</button>
  <input id="sitemapFile" type="file" accept=".xml,text/xml" style="display:none" />
  </div>
</header>

<main>
  <section class="card grid">
    <div>
      <h3 style="margin-top:0">Pages</h3>
      <p class="muted">Drag to reorder. Toggle <em>Visible</em>. Edit titles. “New” = appears in the sitemap but not in your last <b>snapshot</b>. “Stale” = was in your last <b>snapshot</b> but is no longer in the sitemap.</p>
      <ul id="list"></ul>
    </div>
    <div>
      <div class="row" style="margin-top:0; margin-bottom:16px">
        <button id="showInstructionsBtn" class="secondary" style="width:100%">Instructions</button>
      </div>
      <section class="card" style="margin-top:0">
        <h3 style="margin:0 0 8px 0">
          <img src="/super_logo.svg" alt="Super" style="height:22px;vertical-align:middle;margin-right:6px;"> Integration
        </h3>
        <div class="row">
          <button id="copyHeadBtn" class="secondary">Copy Head</button>
          <button id="copyBodyBtn" class="secondary">Copy Body</button>
          <button id="copyCssBtn" class="secondary">Copy CSS</button>
        </div>
      </section>
      <section class="card" style="margin-top:16px" hidden>
        <h3 style="margin:0 0 8px 0">Notion TOC</h3>
        <div class="row">
          <button id="generateMarkdownBtn" class="secondary">Generate Notion TOC</button>
        </div>
        <p class="muted">Create a table of contents for Notion</p>
      </section>
    </div>
  </section>
</main>

<!-- Load Sitemap Modal -->
<div id="sitemapModal" style="position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:10;">
  <div style="background:#fff;border-radius:16px;padding:20px;min-width:480px;box-shadow:var(--shadow)">
    <h3 style="margin-top:0">Load Sitemap</h3>
    <p class="muted" style="margin-top:0">Enter a sitemap.xml URL or select a downloaded file.</p>
    <div class="row" style="margin-top:8px">
      <input id="sitemapUrl" type="url" placeholder="https://example.com/sitemap.xml" style="flex:1" />
      <button id="loadUrlBtn" class="primary">Load URL</button>
    </div>
    <div class="row" style="margin-top:8px">
      <button id="loadFileBtn" class="secondary">Choose sitemap.xml…</button>
      <div style="flex:1"></div>
      <button id="cancelSitemapBtn">Cancel</button>
    </div>
  </div>
  
</div>

<!-- Instructions Modal -->
<div id="instructionsModal" style="position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:10;">
  <div style="background:#fff;border-radius:16px;padding:20px;max-width:720px;width:90%;box-shadow:var(--shadow)">
    <div class="row" style="justify-content:space-between;align-items:center;margin-bottom:8px">
      <h3 style="margin:0">Instructions</h3>
      <button id="closeInstructionsBtn">Close</button>
    </div>
    <div class="help" style="margin-top:0;border:none;padding-top:0">
      <h4>Typical workflow</h4>
      <ul class="steps">
        <li class="step"><span class="num">1</span><div><b>Load Sitemap</b><br/><span class="muted">Start fresh (URL or file). The workspace is reset to the sitemap’s pages.</span></div></li>
        <li class="step"><span class="num">2</span><div><b>Organize pages</b><br/><span class="muted">Drag modules/lessons, toggle <i>Visible</i>, edit titles.</span></div></li>
        <li class="step"><span class="num">3</span><div><b>Save Snapshot</b> <span class="tag optional">recommended</span><br/><span class="muted">Save <code>manifest.json</code> so your organization is preserved.</span></div></li>
        <li class="step"><span class="num">4</span><div><b>Add code to Super</b><br/>
          <span class="tag required">Copy Head</span>
          <span class="tag optional">Copy Body</span>
          <span class="tag optional">Copy CSS</span>
          <div class="muted">Paste into Super → Code. Head is required; Body/CSS enable the sticky Prev/Next bar.</div>
        </div></li>
      </ul>

      <div class="subcard">
        <h4 style="margin-top:0">Notion TOC</h4>
        <div class="muted">Use <b>Generate Notion TOC</b> to copy a markdown table of contents from your current organization.</div>
        <ul style="margin:8px 0 0 16px">
          <li>In Notion, type <code>&gt; </code> to create a Toggle block for a module.</li>
          <li>Paste the generated list and press <kbd>Tab</kbd> to indent lesson links under the toggle.</li>
        </ul>
      </div>

      <h4>Publish to Super</h4>
      <ul class="steps">
        <li class="step"><span class="num">A</span><div><b>Copy Head</b> <span class="tag required">required</span><br/><span class="muted">Paste into Super → Code → Head to embed the <code>lesson-manifest</code>.</span></div></li>
        <li class="step"><span class="num">B</span><div><b>Copy CSS</b> <span class="tag optional">optional</span><br/><span class="muted">Paste into Super → Code → CSS to style the sticky bar.</span></div></li>
        <li class="step"><span class="num">C</span><div><b>Copy Body</b> <span class="tag optional">optional</span><br/><span class="muted">Paste into Super → Code → Body (end) to activate the sticky bar.</span></div></li>
        <li class="step"><span class="num">D</span><div><b>Publish</b><br/><span class="muted">Publish in Super, then hard refresh your site.</span></div></li>
      </ul>
      <div class="callout" style="margin-top:12px">
        <b>Keep your organization next time</b><br/>
        Save a Snapshot after organizing. Next session, Load Snapshot then Load Sitemap to bring in new pages without losing your order and titles. Re‑copy Head to update the live site.
      </div>
      <p class="muted" style="margin-top:12px">Tip: modules default to collapsed for faster reordering. Click ▸ to expand a module. Drag headers to move whole modules; drag rows to move individual lessons.</p>
    </div>
  </div>
</div>

<!-- Save Snapshot (simple) -->
<div id="saveSnapshotModal" style="position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:10;">
  <div style="background:#fff;border-radius:16px;padding:20px;min-width:420px;max-width:520px;width:90%;box-shadow:var(--shadow)">
    <h3 style="margin-top:0">Save Snapshot</h3>
    <p class="muted" style="margin-top:0">Choose where to save <code>manifest.json</code>.</p>
    <div class="row" style="margin-top:8px">
      <button id="saveToDownloadsBtn" class="primary">Save to Downloads</button>
      <button id="saveAsBtn" class="secondary">Save As…</button>
      <div style="flex:1"></div>
      <button id="cancelSaveSnapshotBtn">Cancel</button>
    </div>
  </div>
  
</div>

<!-- Load Snapshot (simple) -->
<div id="loadSnapshotModal" style="position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:10;">
  <div style="background:#fff;border-radius:16px;padding:20px;min-width:420px;max-width:520px;width:90%;box-shadow:var(--shadow)">
    <h3 style="margin-top:0">Load Snapshot</h3>
    <p class="muted" style="margin-top:0">Select a previously saved <code>manifest.json</code>.</p>
    <div class="row" style="margin-top:8px">
      <button id="chooseSnapshotBtn" class="primary">Choose from Downloads…</button>
      <div style="flex:1"></div>
      <button id="cancelLoadSnapshotBtn">Cancel</button>
    </div>
  </div>
</div>

<script>
// Copy of the same JS from toc-manager.html
// For maintainability, we could factor this into a separate JS file later.
</script>
<!-- Inline the same script by referencing the parent file via duplication is avoided here; to keep this robust now, we include the same JS by inlining a minimal redirect to the parent if needed. -->
<script>
// Quick loader: if this page ever falls behind, redirect to root file
// but currently the content is identical, so nothing to do.
</script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="refresh" content="0; url=../toc-manager.html" />
  <title>Redirecting…</title>
  <link rel="icon" type="image/png" href="../public/favicon.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;padding:40px;}</style>
</head>
<body>
  Redirecting to <a href="../toc-manager.html">TOC Manager</a>…
  <script>location.replace('../toc-manager.html');</script>
</body>
</html>


